--liquibase formatted sql

--changeset michael-bill:add_test_data

-- 1. Заполнение workspace
insert into workspace (name, title, created_at) values
('ws1', 'Первое рабочее пространство', '2024-01-01 09:00:00'),
('ws2', 'Второе рабочее пространство', '2024-02-01 10:00:00');

-- 2. Заполнение users
insert into users (username, password, role) values
('admin', '$2a$10$RPNOc9j0WOphyWlKxqzs1ukBSm2yI0WszzqCMv4oHwvFE0hjrtEQm', 'ADMIN'),
('user1', '$2a$10$BkyS7WBOpdq/IWnwdd49u.65xbKC7EVAUWlWnYNyrmZP1jIIe6eqi', 'USER'),
('user2', '$2a$10$YRlZeQZ9h.TOFPfsbR083OcWyyJWpZfV6K7UvNJ4XFdIZyt4Kx7nW', 'USER'),
('manager', '$2a$10$Kcwrys2Fic0lRCfG0SAljeR1H4GaS6QkQ0fr4nTwy/ZTX2ndmtREW', 'USER');

-- 3. Связываем пользователей с workspace
insert into user_workspace (user_id, workspace_id, role_id) values
(1, 'ws1', 1),
(2, 'ws1', 2),
(3, 'ws1', 3),
(4, 'ws2', 1),
(1, 'ws2', 2),
(2, 'ws2', 3),
(3, 'ws2', 2);

-- 4. Обновляем current_workspace_id
update users set current_workspace_id = 'ws1' where id in (1,2,3);
update users set current_workspace_id = 'ws2' where id = 4;

-- 5. Создаем колонки доски
insert into board_columns (workspace_id, title, level, color) values
('ws1', 'Запланировано', 1, '#FF0000'),
('ws1', 'В работе', 2, '#00FF00'),
('ws1', 'Готово', 3, '#0000FF'),
('ws2', 'Backlog', 1, '#CCCCCC'),
('ws2', 'Sprint', 2, '#FFFF00'),
('ws1', 'Review', 4, '#FFA500'),
('ws1', 'Testing', 5, '#800080'),
('ws1', 'Deployed', 6, '#008000'),
('ws2', 'Done', 3, '#00FF00'),
('ws2', 'Blocked', 4, '#FF0000');

-- 6. Создаем спринты
insert into sprint (workspace_id) values
('ws1'), ('ws1'), ('ws2'),
('ws1'), ('ws1'), ('ws1'),
('ws2'), ('ws2'), ('ws1'),
('ws1');

-- 7. Создаем папки
insert into folder (user_id, name, workspace_id) values
(1, 'Мои чаты', 'ws1'),
(2, 'Архив', 'ws1'),
(4, 'Основные', 'ws2'),
(1, 'Проекты', 'ws1'),
(2, 'Личное', 'ws1'),
(3, 'Заметки', 'ws1'),
(4, 'Временное', 'ws2'),
(1, 'Архив 2024', 'ws1'),
(2, 'Черновики', 'ws1'),
(4, 'Общее', 'ws2');

-- 8. Заполняем чаты
insert into chat (workspace_id, created_by, created_at, title, type) values
('ws1', 1, '2024-01-02 10:00:00', 'Общий чат', 'GROUP'),
('ws1', 2, '2024-01-03 11:00:00', 'Технические вопросы', 'CHANNEL'),
('ws1', 3, '2024-01-03 11:30:00', null, 'PRIVATE'),
('ws2', 4, '2024-02-02 12:00:00', 'Основной чат', 'GROUP'),
('ws1', 1, '2024-01-04 10:00:00', 'Обсуждение задач', 'CHANNEL'),
('ws1', 2, '2024-01-05 11:00:00', 'Дизайн', 'GROUP'),
('ws1', 3, '2024-01-06 12:00:00', null, 'PRIVATE'),
('ws1', 1, '2024-01-07 13:00:00', 'Техподдержка', 'CHANNEL'),
('ws2', 4, '2024-02-03 14:00:00', 'Разработка', 'GROUP'),
('ws2', 4, '2024-02-04 15:00:00', 'Встречи', 'CHANNEL');

-- 9. Связь пользователей с чатами
insert into chat_user (chat_id, user_id, join_at, role_id) values
(1, 1, '2024-01-02 10:00:00', 1),
(1, 2, '2024-01-02 10:05:00', 2),
(2, 2, '2024-01-03 11:00:00', 1),
(3, 1, '2024-02-02 12:00:00', 1),
(3, 2, '2024-02-02 12:00:00', 1),
(5, 1, '2024-01-04 10:00:00', 1),
(5, 3, '2024-01-04 10:05:00', 2),
(6, 2, '2024-01-05 11:00:00', 1),
(7, 3, '2024-01-06 12:00:00', 1),
(9, 4, '2024-02-03 14:00:00', 1);

-- 10. Сообщения
insert into messages (chat_id, sender_id, text_content, created_at) values
(1, 1, 'Добро пожаловать в общий чат!', '2024-01-02 10:00:00'),
(1, 2, 'Привет всем!', '2024-01-02 10:05:00'),
(3, 4, 'Начинаем новый проект', '2024-02-02 12:05:00'),
(1, 3, 'Как дела?', '2024-01-02 10:10:00'),
(2, 1, 'Начинаем работу', '2024-01-03 11:05:00'),
(5, 2, 'Новые задачи добавлены', '2024-01-04 10:15:00'),
(6, 3, 'Дизайн готов?', '2024-01-05 11:30:00'),
(7, 1, 'Привет!', '2024-01-06 12:05:00'),
(9, 4, 'Обсудим проект', '2024-02-03 14:10:00'),
(10, 4, 'Планируем встречу', '2024-02-04 15:15:00');

-- 11. Карточки
insert into card (column_id, created_by, sprint_id, title, content, deadline) values
(1, 1, 1, 'Настройка сервера', 'Установить необходимое ПО', '2026-02-02 12:05:00'),
(2, 2, 1, 'Разработка фичи', 'Интеграция с API', '2026-02-02 12:05:00'),
(5, 4, 3, 'Планирование', 'Составить roadmap', '2026-02-02 12:05:00'),
(6, 1, 4, 'Доработка интерфейса', 'Обновить дизайн страниц', '2024-03-01'),
(7, 2, 5, 'Тестирование', 'Провести нагрузочное тестирование', '2024-03-05'),
(8, 3, 6, 'Деплой', 'Выкатить на прод', '2024-03-10'),
(9, 4, 7, 'Сбор требований', 'Интервью с заказчиком', '2024-04-01'),
(10, 1, 8, 'Рефакторинг', 'Улучшить структуру кода', '2024-04-05'),
(3, 2, 9, 'Документация', 'Написать руководство пользователя', '2024-04-10'),
(4, 3, 10, 'Интеграция', 'Подключить платежную систему', '2024-05-01');

-- 12. Комментарии к карточкам
insert into card_comments (user_id, card_id, content) values
(1, 1, 'Начните с установки Docker'),
(2, 2, 'API документация готова?'),
(3, 3, 'Нужно уточнить требования'),
(4, 4, 'Тесты пройдены успешно'),
(1, 5, 'Готово к деплою'),
(2, 6, 'Требования собраны'),
(3, 7, 'Рефакторинг завершен'),
(4, 8, 'Документация проверена'),
(1, 9, 'Интеграция выполнена'),
(2, 10, 'Все работает отлично');
